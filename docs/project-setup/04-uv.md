---
id: 04-uv
title: uv
sidebar_position: 4
description: Learn how to manage Python projects using uv
---
# uv

[uv](https://docs.astral.sh/uv/) is a high-performance Python package and project manager that unifies the entire Python development workflow behind a single, fast CLI. It handles Python installation, dependency resolution, virtual environments, script execution, package building, and publishing to package indexes.

uv is designed as a practical replacement for tools such as `pip`, `pip-tools`, `pipx`, `poetry`, `pyenv`, `virtualenv`, and `twine`, offering one consistent and predictable interface.

---

## Quick Installation

```bash
# macOS and Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows (PowerShell)
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"

# Windows (winget)
winget install --id=astral-sh.uv -e

# Verify installation
uv --version
````

Additional installation options are documented [here](https://docs.astral.sh/uv/getting-started/installation/#installing-uv)

---

## Project Management

uv uses `pyproject.toml` as the source of truth for configuration and `uv.lock` to ensure reproducible dependency resolution.

## Initialize a New Project

```bash
# Create a new project directory
uv init my_project

# Create with a specific project type
uv init --package my_lib_name        # Python package
uv init --app my_app_name            # Application
uv init --lib my_library_name        # Library

# Create a single-file script
uv init --script my_script_name.py
```

## Add Dependencies

```bash
# Production dependencies
uv add rich requests pandas numpy

# Development dependencies
uv add --dev pytest pytest-cov  ruff black

# Import from requirements file
uv add -r requirements.txt

# Platform or Python-specific dependency
uv add --python 3.12 numpy
```

## Manage the Project Environment

```bash
# Install dependencies
uv sync

# Enforce exact versions from uv.lock
uv sync --locked

# Generate or update the lockfile
uv lock

# Upgrade all dependencies
uv lock --upgrade

# Inspect dependency graph
uv tree
```

## Run Project Commands

```bash
# Run a Python script
uv run python main.py

# Run tests
uv run pytest

# Use a specific Python version
uv run --python 3.11 pytest

# Run with temporary dependencies
uv run --with pandas my_script_name.py
```

---

## Script Execution

uv supports running standalone scripts with automatic dependency handling.

## Basic Script Execution

```bash
# Run a script with detected dependencies
uv run my_script_name.py

# Run with additional temporary dependencies
uv run --with requests my_script_name.py
```

## Inline Script Dependencies (PEP 723)

Dependencies can be declared directly inside Python scripts using PEP 723 metadata:

```python
# /// script
# dependencies = ["requests", "rich"]
# requires-python = ">=3.8"
# ///

import requests
from rich import print
```

Add dependencies to an existing script:

```bash
uv add --script my_script_name.py requests rich
```

PEP 723 specification:
[https://peps.python.org/pep-0723/](https://peps.python.org/pep-0723/)

---

## Tool Management

uv simplifies running and managing Python-based CLI tools.

### Ephemeral Tool Execution with `uvx`

```bash
# Run tools without installation
uvx ruff check .
uvx black --check .
uvx pytest tests/

# Use a specific Python version
uvx --python 3.12 mypy .

# Run with temporary dependencies
uvx --with pandas my_data-script_name.py
```

### Global Tool Installation

```bash
# Install tools globally
uv tool install ruff black mypy

# List installed tools
uv tool list

# Upgrade tools
uv tool upgrade ruff
uv tool upgrade --all
```

---

## pip-Compatible Workflows

uv provides a fast, compatible alternative to traditional `pip` workflows.

### Virtual Environment Management

```bash
# Create a virtual environment
uv venv

# Create with a specific Python version
uv venv --python 3.12
```

Activate the environment:

```bash
# Unix and macOS
source .venv/bin/activate

# Windows
.venv\Scripts\activate
```

### Package Installation

```bash
uv pip install requests
uv pip install -r requirements.txt
uv pip install -e .
uv pip install --constraint constraints.txt
uv pip install git+https://github.com/user/repo.git
```

### Dependency Resolution

```bash
# Generate a lockfile
uv pip compile requirements.in

# Cross-platform lockfile
uv pip compile --universal requirements.in

# Target a specific Python version
uv pip compile --python 3.12 requirements.in

# Sync environment from lockfile
uv pip sync requirements.txt
```

---

## Python Version Management

uv can install and manage Python runtimes directly.

```bash
# List available versions
uv python list

# Install a specific version
uv python install 3.12

# Install a prerelease version
uv python install 3.13.0-alpha.1

# Pin Python for the project
uv python pin 3.11

# Run with a specific Python
uv run --python 3.10 my_script_name.py
```

---

## Building and Publishing

### Build Packages

```bash
# Build source and wheel distributions
uv build

# Build specific formats
uv build --sdist
uv build --wheel

# Build for a specific platform and Python
uv build --platform windows --python 3.11
```

### Publish Packages

```bash
# Publish to PyPI
uv publish

# Publish to TestPyPI
uv publish --publish-url https://test.pypi.org/legacy/

# Publish with a token
uv publish --token pypi-xxxxxxxxxxxx

# Dry run
uv publish --dry-run
```

---

## Version Management

Manage project versions directly from the CLI.

```bash
# Show current version
uv version

# Set an explicit version
uv version 1.2.3

# Increment versions
uv version --bump patch
uv version --bump minor
uv version --bump major

# Show version history
uv version --history
```

---

## Best Practices

### Recommended Project Layout

```text
my-project/
├── pyproject.toml
├── uv.lock
├── src/
├── tests/
└── README.md
```

### Typical Development Workflow

```bash
uv init my-project
uv add requests pandas
uv add --dev pytest ruff
uv sync
uv run pytest
uv run --with black black --check .
```

### CI Integration Example

```yaml
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: astral-sh/setup-uv@v3
      - run: uv sync
      - run: uv run pytest
```

### Environment Variables

```bash
export UV_CACHE_DIR=/tmp/uv-cache
export UV_INDEX_URL=https://pypi.org/simple/
export UV_HTTP_TIMEOUT=30
export UV_PYTHON_INSTALL_DIR=$HOME/.local/uv/python
```

---

## Performance Tips

1. Share the global cache across projects
2. Prefer `--locked` when a lockfile exists
3. Take advantage of parallel operations
4. Reuse persistent virtual environments

---

## Migration

For detailed guidance on migrating from other tools, [see](./06-uv-migraton.md)
